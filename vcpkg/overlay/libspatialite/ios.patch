diff --color -ru a/src/gaiaaux/gg_utf8.c b/src/gaiaaux/gg_utf8.c
--- a/src/gaiaaux/gg_utf8.c	2020-08-23 18:46:22.000000000 +0200
+++ b/src/gaiaaux/gg_utf8.c	2021-06-15 07:09:20.180762410 +0200
@@ -73,7 +73,7 @@
 #include <localcharset.h>
 #endif /* end localcharset */
 #else /* not MINGW32 - WIN32 */
-#if defined(__APPLE__) || defined(__ANDROID__)
+#if defined(MACOS) || defined(__ANDROID__)
 #include <iconv.h>
 #include <localcharset.h>
 #else /* neither Mac OsX nor Android */
@@ -89,7 +89,7 @@
 #if defined(__MINGW32__) || defined(_WIN32)
     return locale_charset ();
 #else /* not MINGW32 - WIN32 */
-#if defined(__APPLE__) || defined(__ANDROID__)
+#if defined(MACOS) || defined(__ANDROID__)
     return locale_charset ();
 #else /* neither Mac OsX nor Android */
     return nl_langinfo (CODESET);
diff --color -ru a/src/gaiageo/gg_shape.c b/src/gaiageo/gg_shape.c
--- a/src/gaiageo/gg_shape.c	2020-08-23 18:46:22.000000000 +0200
+++ b/src/gaiageo/gg_shape.c	2021-06-15 07:09:20.182762418 +0200
@@ -71,7 +71,7 @@
 #include <localcharset.h>
 #endif /* end localcharset */
 #else /* not MINGW32 */
-#if defined(__APPLE__) || defined(__ANDROID__)
+#if defined(MACOS) || defined(__ANDROID__)
 #include <iconv.h>
 #include <localcharset.h>
 #else /* neither Mac OsX nor Android */
